## 📈 감성 지수를 활용한 주가 예측 모델
### 주가 예측 모델 설계 _(서울대학교 빅데이터 핀테크 전문가 과정 6기, 6조 팀프로젝트)_
 - 핵심 역할 : 뉴스 크롤링 및 감성 지수 계산, 모델링에 필요한 시계열 데이터 생성

 ### 프로젝트 개요  
 - 목적 : 경제 뉴스의 감성 지수와 거시 경제 지표들을 통해 주가 등락 예측 모델 개발

 - 데이터 : 뉴스 감성 지수 데이터 + 거시 경제 지표에 대한 시계열 자료 직접 생성
   - 데이터 형태 : 2020년 1월 ~ 2023년 3월 까지의 시계열 데이터
   - 사용변수 : 소비자물가지수, 금리, 환율, 감성 점수, 주가지수
  
 - 데이터 처리
   - 뉴스 크롤링 : Newspaper 라이브러리로 매일 경제의 해당 기간 모든 뉴스 중 ‘경제' 뉴스만 크롤링
   - 감성 분석 : 크롤링한 내용을 CLOVA Summary API를 통해 요약 후 CLOVA Sentiment API를 사용하여 감성 분석
   - 감성 지수화 : 해당 날짜의 감성 분석 값에 대해 (해당 일 기사 개수 / 전체 기사 개수)로 기사 개수에 대한 가중치와 긍정 +1, 중립 0, 부정 -1 가중치 부여하여 지수화
   - 거시 경제 변수 생성 : 주가 지수(KOSPI 200), 이자율(KORIBO), 금 값(1kg 기준), 유가(휘발유, 등유, 경유 평균가), 환율(KRX 데이터), CPI(소비자 물가지수 월 별 제공 -> 선형 보간법으로 일 별 데이터 생성)
   - 결측치 처리 : 뉴스, 주가, 이자율 등 휴일인 경우 관측되지 않기 때문에 해당 행 삭제
    
- 사용한 모델
   - Prophet, 1D CNN, Transformer
   - 각 모델 별 변수들을 다양하게 사용하며 결과 비교
  
   
### 프로젝트 결과 
- 시계열 자료 예측값의 오차 결과
  
| Model          | RMSE  | MAE   | Features                                    |
|-----------------|-------|-------|---------------------------------------------|
| Prophet         | 17.71 | 10.55 | Interest, Exchange rate, Sentiment score, KOSPI200 |
| 1D CNN          | 13.10 | 11.30 | CPI, Interest, Exchange rate, Sentiment score, KOSPI200 |
| Transformer     | 13.83 | 10.37 | Interest, Exchange rate, Sentiment score, KOSPI200 |  

- 등락을 0, 1로 마킹하였을 때 결과

| Model      | Accuracy | Precision | Recall | F1 Score |
|-------------|----------|-----------|--------|----------|
| Prophet (감성 지수 X)     | 0.47     | 0.48      | 0.49   | 0.49     |
| Prophet (감성 지수 O)     | 0.49     | 0.51      | 0.51   | 0.51     |
| 1D CNN (감성 지수 X)     | 0.46     | 0.49      | 0.37   | 0.42     |
| 1D CNN (감성 지수 O)      | 0.59     | 0.62      | 0.57   | 0.6      |
| Transformer (감성 지수 X) | 0.51     | 0.53      | 0.62   | 0.57     |  
| Transformer (감성 지수 O) | 0.67     | 0.69      | 0.68   | 0.69     |


- Transformer 모델의 경우 감성 지수를 추가하였을 경우 유의미한 성능 향상 및 변곡점을 더 잘 찾아냄을 볼 수 있음
<img width="321" alt="image" src="https://github.com/choims12/portfolio/assets/118867938/3e43a98e-d256-492b-a327-4598d29ad3dc">

  
  
### 배운 점   
- 직접 주제를 선정하고 데이터를 생성하는 과정에서 유의미한 데이터를 뽑아내기가 매우 어려움
- 목적에 맞는 데이터 선정 및 수집, 변수 생성, 모델 구축, 결과 도출 까지의 과정 모두가 매우 중요
